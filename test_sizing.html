<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message Box Sizing Test</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #0b141a;
            color: #e9edef;
        }
        .test-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #202c33;
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
            max-width: 250px;
        }
        .test-controls h3 {
            margin: 0 0 10px 0;
            color: #00a884;
        }
        .test-controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px;
            background: #2a3942;
            color: #e9edef;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-controls button:hover {
            background: #384e5a;
        }
        .info {
            font-size: 12px;
            color: #8696a0;
            margin: 10px 0;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div class="test-controls">
        <h3>Message Sizing Test</h3>
        <button onclick="addShortMessage()">Add Short Message</button>
        <button onclick="addMediumMessage()">Add Medium Message</button>
        <button onclick="addLongMessage()">Add Long Message</button>
        <button onclick="addVeryShortMessage()">Add "Hi"</button>
        <button onclick="clearMessages()">Clear All</button>
        <div class="info">
            Test different message lengths to verify proper sizing.
        </div>
    </div>

    <div id="chat-container">
        <div id="header-bar">
            <span class="user-id">Test User</span>
            <span class="status-online">Online</span>
        </div>
        <ul id="messages"></ul>
    </div>

    <script>
        let currentUser = 'i';
        let messageCount = 0;

        function getCurrentTime() {
            return new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
        }

        function createMessageElement(messageData) {
            const isMyMessage = messageData.senderID === currentUser;
            const status = messageData.status || 'sent';

            const li = document.createElement('li');
            li.className = `message-bubble ${isMyMessage ? 'my-message' : 'their-message'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            const textSpan = document.createElement('span');
            textSpan.className = 'message-text';
            textSpan.textContent = messageData.message;
            contentDiv.appendChild(textSpan);
            
            li.appendChild(contentDiv);

            const timeSpan = document.createElement('span');
            timeSpan.className = 'message-time';
            timeSpan.textContent = getCurrentTime();
            
            if (isMyMessage) {
                const statusSpan = document.createElement('span');
                statusSpan.classList.add(`status-${status}`);
                statusSpan.innerHTML = status === 'read' ? '✓✓' : '✓';
                timeSpan.appendChild(statusSpan);
            }

            li.appendChild(timeSpan);
            return li;
        }

        function addMessage(message, sender = 'i') {
            const messages = document.getElementById('messages');
            const messageData = {
                senderID: sender,
                message: message,
                type: 'text',
                status: 'sent',
                timestamp: new Date().toISOString()
            };
            
            const messageElement = createMessageElement(messageData);
            messages.appendChild(messageElement);
            messages.scrollTop = messages.scrollHeight;
            
            // Log the actual width for debugging
            const rect = messageElement.getBoundingClientRect();
            console.log(`Message "${message.substring(0, 20)}..." width: ${rect.width}px`);
        }

        function addShortMessage() {
            addMessage('Hello there!', 'i');
            addMessage('Hi back!', 'x');
        }

        function addMediumMessage() {
            addMessage('This is a medium length message that should still be compact and not too wide', 'i');
            addMessage('I agree, message bubbles should size themselves to the content naturally', 'x');
        }

        function addLongMessage() {
            addMessage('This is a much longer message that demonstrates how the text wrapping should work properly while still keeping the message bubble compact and not unnecessarily wide, only expanding as needed to accommodate the text content within the maximum width constraints', 'i');
            addMessage('Exactly! The bubble should grow with content but stay tight and not have extra empty space on the sides, making it look like a natural chat message', 'x');
        }

        function addVeryShortMessage() {
            addMessage('Hi', 'i');
            addMessage('Hey', 'x');
            addMessage('OK', 'i');
            addMessage('Yes', 'x');
        }

        function clearMessages() {
            document.getElementById('messages').innerHTML = '';
            messageCount = 0;
        }

        // Add some initial test messages
        window.addEventListener('load', () => {
            setTimeout(() => {
                addVeryShortMessage();
                setTimeout(addShortMessage, 500);
                setTimeout(addMediumMessage, 1000);
                setTimeout(addLongMessage, 1500);
            }, 100);
        });
    </script>
</body>
</html>