<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Delete Action - Working Version</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #0b141a;
            color: #e9edef;
            display: flex;
            flex-direction: column;
            height: 100vh;
            box-sizing: border-box;
        }

        /* --- Selection Screen --- */
        #initial-user-selection {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            height: 100%;
            width: 100%;
        }

        .user-buttons button {
            margin: 10px;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            background-color: #2a3942;
            color: #e9edef;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .user-buttons button:hover {
            background-color: #384e5a;
        }

        /* --- Chat Container --- */
        #chat-container {
            display: none;
            flex-direction: column;
            height: 100vh;
            width: 100%;
            box-sizing: border-box;
        }

        /* --- Header Bar --- */
        #header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: #202c33;
            color: #e9edef;
            position: fixed;
            top: 0;
            width: 100%;
            box-sizing: border-box;
            z-index: 10;
        }

        .user-id {
            font-weight: bold;
            color: #00a884;
            font-size: 1.1em;
        }

        .other-user-label {
            font-weight: 600;
            color: #e9edef;
            font-size: 1.0em;
        }

        .status-online {
            color: #00a884;
            font-weight: normal;
            font-size: 0.9em;
        }

        /* --- Messages Container --- */
        #messages {
            list-style-type: none;
            margin: 80px 0 80px 0;
            padding: 20px;
            overflow-y: auto;
            width: 100%;
            box-sizing: border-box;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }

        /* --- Message Bubbles --- */
        .message-bubble {
            display: inline-flex;
            flex-direction: column;
            width: fit-content;
            max-width: 65%;
            margin-bottom: 12px;
            padding: 8px 10px;
            border-radius: 10px;
            position: relative;
            word-wrap: break-word;
            box-shadow: 0 1px 0.5px rgba(0, 0, 0, 0.13);
            transition: background-color 0.2s ease;
        }

        .message-bubble:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .my-message {
            background-color: #005c4b;
            align-self: flex-end;
            margin-left: auto;
        }

        .their-message {
            background-color: #202c33;
            align-self: flex-start;
            margin-right: auto;
        }

        /* --- Delete Button --- */
        .delete-btn {
            position: absolute;
            top: -5px;
            right: -8px;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 15;
            background: rgba(255, 107, 107, 0.9);
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .message-bubble:hover .delete-btn {
            opacity: 1;
        }

        .delete-btn:hover {
            background: rgba(255, 107, 107, 1);
        }

        .deleted-message {
            opacity: 0.5;
            font-style: italic;
            color: #8696a0;
        }

        .message-time {
            font-size: 0.7em;
            color: rgba(255, 255, 255, 0.6);
            align-self: flex-end;
            margin-top: 3px;
            white-space: nowrap;
        }

        /* --- Input Form --- */
        #form {
            display: flex;
            align-items: flex-end;
            padding: 8px 10px;
            background-color: #1f2c33;
            position: fixed;
            bottom: 0;
            width: 100%;
            box-sizing: border-box;
            z-index: 10;
        }

        #input {
            flex-grow: 1;
            min-height: 40px;
            max-height: 120px;
            padding: 10px 15px;
            margin: 0 8px;
            border: none;
            border-radius: 20px;
            background-color: #2a3942;
            color: #e9edef;
            resize: none;
            overflow-y: auto;
            font-size: 1em;
            box-sizing: border-box;
        }

        #send-button {
            flex-shrink: 0;
            width: 44px;
            height: 44px;
            padding: 0;
            margin: 0 3px;
            border: none;
            border-radius: 50%;
            background-color: #00a884;
            color: white;
            cursor: pointer;
        }

        .demo-info {
            background-color: #1f2c33;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
            max-width: 400px;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>

    <div id="initial-user-selection">
        <h1>Who are you chatting as?</h1>
        <div class="user-buttons">
            <button onclick="selectUser('i')">Chat as: i</button>
            <button onclick="selectUser('x')">Chat as: x</button>
        </div>
        <p>(Select a user to begin chat simulation)</p>
        
        <div class="demo-info">
            <strong>üóëÔ∏è Simple Delete Action Demo</strong><br>
            Only delete option is available. Hover over YOUR OWN messages (green) to see the delete button (X).<br><br>
            ‚Ä¢ You can only delete your own messages<br>
            ‚Ä¢ Other users' messages (gray) have no delete button<br>
            ‚Ä¢ Deleted messages show "This message was deleted"
        </div>
    </div>

    <div id="chat-container">
        
        <div id="header-bar">
            <div id="user-info-left">
                <span id="my-user-id-display" class="user-id"></span>
            </div>
            <div id="user-info-right">
                <span id="other-user-name" class="other-user-label"></span>
                <span id="other-user-status" class="status-online">Online</span>
            </div>
        </div>
        
        <ul id="messages"></ul>

        <form id="form" action="">
            <textarea id="input" autocomplete="off" placeholder="Type a message..." rows="1"></textarea>
            <button id="send-button" type="submit">Send</button>
        </form>

    </div>

    <script>
        let currentUser = null;
        let messageIdCounter = 1;
        let messages = [];

        function createMessage(sender, message, type = 'text') {
            const messageId = 'msg-' + messageIdCounter++;
            const messageData = {
                _id: messageId,
                senderID: sender,
                message: message,
                type: type,
                deleted: false,
                timestamp: new Date().toISOString()
            };
            
            messages.push(messageData);
            renderMessage(messageData);
            return messageId;
        }

        function renderMessage(messageData) {
            const messagesContainer = document.getElementById('messages');
            const isMyMessage = messageData.senderID === currentUser;
            
            const li = document.createElement('li');
            li.className = `message-bubble ${isMyMessage ? 'my-message' : 'their-message'}`;
            li.dataset.messageId = messageData._id;

            // Delete Button - ONLY for own messages
            if (isMyMessage && !messageData.deleted) {
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-btn';
                deleteBtn.innerHTML = '‚úï';
                deleteBtn.title = 'Delete message';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    deleteMessage(messageData._id);
                };
                li.appendChild(deleteBtn);
            }

            // Message Content
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            if (messageData.deleted) {
                contentDiv.innerHTML = '<span class="deleted-message">This message was deleted</span>';
            } else if (messageData.type === 'image') {
                const img = document.createElement('img');
                img.src = messageData.message;
                img.style.cssText = 'max-width: 100%; height: auto; border-radius: 6px;';
                contentDiv.appendChild(img);
            } else {
                const textSpan = document.createElement('span');
                textSpan.className = 'message-text';
                textSpan.textContent = messageData.message;
                contentDiv.appendChild(textSpan);
            }
            
            li.appendChild(contentDiv);

            // Time
            const timeSpan = document.createElement('span');
            timeSpan.className = 'message-time';
            timeSpan.textContent = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
            
            li.appendChild(timeSpan);
            messagesContainer.appendChild(li);
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function deleteMessage(messageId) {
            if (confirm('Are you sure you want to delete this message?')) {
                // Find and update message data
                const messageData = messages.find(m => m._id === messageId);
                if (messageData) {
                    messageData.deleted = true;
                    
                    // Remove the message element and re-render
                    const messageElement = document.querySelector(`[data-message-id="${messageId}"]`);
                    if (messageElement) {
                        messageElement.remove();
                    }
                    
                    // Re-render the deleted message
                    renderMessage(messageData);
                    
                    console.log('Message deleted successfully');
                }
            }
        }

        function selectUser(userId) {
            currentUser = userId;
            
            document.getElementById('initial-user-selection').style.display = 'none';
            document.getElementById('chat-container').style.display = 'flex';
            document.getElementById('my-user-id-display').textContent = 'USER ' + userId.toUpperCase();
            
            const otherUser = userId === 'i' ? 'x' : 'i';
            document.getElementById('other-user-name').textContent = 'USER ' + otherUser.toUpperCase();
            
            // Load demo messages
            loadDemoMessages();
        }

        function loadDemoMessages() {
            // Create sample messages
            createMessage('i', 'This is YOUR message (green). Hover over it to see the delete button X.');
            createMessage('x', 'This is OTHER user message (gray). No delete button for you.');
            createMessage('i', 'You can delete this message by clicking the X button.');
            createMessage('x', 'Only the sender can delete their own messages.');
            createMessage('i', 'Try deleting this message! It will show "This message was deleted".');
        }

        // Form submission
        document.getElementById('form').addEventListener('submit', (e) => {
            e.preventDefault();
            const input = document.getElementById('input');
            if (input.value.trim()) {
                createMessage(currentUser, input.value.trim());
                input.value = '';
            }
        });

        // Auto-resize textarea
        document.getElementById('input').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });
    </script>
</body>
</html>